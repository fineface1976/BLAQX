<!DOCTYPE html>
<html>
<head>
    <title>BLAQX Admin Dashboard</title>
    <base href="/BLAQX/admin/">
    <style>
        :root {
            --admin-bg: #2c3e50;
            --admin-text: white;
        }

        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 20px;
            background: var(--admin-bg);
            color: var(--admin-text);
        }

        .admin-container {
            max-width: 1200px;
            margin: 0 auto;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 1rem;
            margin: 2rem 0;
        }

        .stat-card {
            background: rgba(255,255,255,0.1);
            padding: 1.5rem;
            border-radius: 10px;
        }

        .config-section {
            background: rgba(0,0,0,0.3);
            padding: 1.5rem;
            border-radius: 10px;
            margin: 2rem 0;
        }
    </style>
</head>
<body>
    <!-- Auth Check -->
    <script>
        if (!localStorage.getItem('blaqxAdminAuth')) {
            window.location.href = 'admin-login.html';
        }
    </script>

    <div class="admin-container">
        <h1>Admin Dashboard</h1>

        <!-- System Stats -->
        <div class="stats-grid">
            <div class="stat-card">
                <h3>Total Users</h3>
                <p id="totalUsers">Loading...</p>
            </div>
            <div class="stat-card">
                <h3>Active Trades</h3>
                <p id="activeTrades">0</p>
            </div>
            <div class="stat-card">
                <h3>Total Volume</h3>
                <p id="totalVolume">$0.00</p>
            </div>
        </div>

        <!-- Configuration Section -->
        <div class="config-section">
            <h2>System Configuration</h2>
            
            <!-- Flutterwave API Control -->
            <div style="margin: 1rem 0;">
                <label>Flutterwave Public Key:</label>
                <input type="password" id="fwKey" style="width: 400px; padding: 0.5rem;">
                <button onclick="saveFWKey()">Update</button>
            </div>

            <!-- Token Price Control -->
            <div style="margin: 1rem 0;">
                <label>BLAQX Token Price (USD):</label>
                <input type="number" id="tokenPrice" step="0.01" style="width: 150px; padding: 0.5rem;">
                <button onclick="saveTokenPrice()">Update</button>
            </div>
        </div>

        <!-- User Management -->
        <div class="user-table" style="margin: 2rem 0;">
            <h2>Recent Users</h2>
            <div id="userList"></div>
        </div>
    </div>

    <!-- Unified Admin Script -->
    <script>
        // System Configuration
        let config = JSON.parse(localStorage.getItem('blaqxConfig')) || {
            tokenPrice: 0.50,
            fwPublicKey: 'FLWPUBK-TEST-XXXXXXXXXXXX-X',
            users: [],
            transactions: []
        };

        // Load Configuration
        document.getElementById('fwKey').value = config.fwPublicKey;
        document.getElementById('tokenPrice').value = config.tokenPrice;

        // Save Handlers
        function saveFWKey() {
            const newKey = document.getElementById('fwKey').value;
            if (newKey.startsWith('FLWPUBK-')) {
                config.fwPublicKey = newKey;
                localStorage.setItem('blaqxConfig', JSON.stringify(config));
                localStorage.setItem('blaqxFlutterwaveKey', newKey);
                alert('API key updated!');
            } else {
                alert('Invalid Flutterwave key format!');
            }
        }

        function saveTokenPrice() {
            const newPrice = parseFloat(document.getElementById('tokenPrice').value);
            if (newPrice > 0) {
                config.tokenPrice = newPrice;
                localStorage.setItem('blaqxConfig', JSON.stringify(config));
                alert('Price updated!');
            }
        }

        // User Data
        function loadUsers() {
            // In real system: fetch from API
            document.getElementById('totalUsers').textContent = config.users.length;
            document.getElementById('userList').innerHTML = config.users
                .map(user => `<div>${user.email} - ${user.balance} BLAQX</div>`)
                .join('');
        }

        // Initial Load
        loadUsers();
    </script>
</body>
</html>
